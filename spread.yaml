project: spread-images

backends:
    linode:
        key: "$(HOST: echo $SPREAD_LINODE_KEY)"
        systems:
            - ubuntu-16.04-64:
                kernel: GRUB 2
            - ubuntu-16.04-32:
                kernel: GRUB 2
            - ubuntu-16.10-64:
                kernel: GRUB 2
            - ubuntu-17.04-64:
                kernel: GRUB 2
            - ubuntu-17.10-64:
                kernel: GRUB 2
            - debian-unstable-64:
                kernel: GRUB 2
            - fedora-25-64

path: /root/spread

restore: |
    case "$SPREAD_SYSTEM" in
        fedora-*)
            dnf clean all -y
            dnf clean metadata
            find /var/log -type f -exec rm -f {} \;
            ;;
        debian-*)
            ;&
        ubuntu-*)
            apt autoremove -y

            find \
                /var/log \
                /var/cache/apt \
                /var/lib/apt/{lists,mirrors} \
                -type f -exec rm -f {} \;
            ;;
        *)
            ;;
    esac

    rm -rf \
        /root/.bash_history \
        /root/.viminfo \
        /root/.bashrc \
        /root/.cache \
        /root/spread

suites:
    tasks/:
        summary: Image maintenace tasks
